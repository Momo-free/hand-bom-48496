<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hand.demo.infra.mapper.MenuMapper">
    <select id="menuComboList" resultType="com.hand.demo.api.controller.v1.dto.MenuComboDto">
        SELECT
        menu.menu_name AS menuName,
        menu.menu_code AS menuCode,
        menu.menu_owner AS menuOwner,
        combo.combo_name AS comboName,
        combo.combo_code AS comboCode,
        combo.combo_type AS comboType,
        combo.sales_area AS salesArea,
        combo.combo_start_date AS comboStartDate,
        combo.combo_end_date AS comboEndDate,
        combo.combo_owner AS comboOwner
        FROM
        menu
        LEFT JOIN
        combo
        ON menu.id = combo.menu_id
        <where>
            menu.tenant_id = #{tenantId}
            <!-- 动态条件：菜单名称 -->
            <if test="menuComboDto.menuName != null and menuComboDto.menuName != ''">
                AND menu.menu_name LIKE CONCAT('%', #{menuComboDto.menuName}, '%')
            </if>

            <!-- 动态条件：菜单负责人 -->
            <if test="menuComboDto.menuOwner != null and menuComboDto.menuOwner != ''">
                AND menu.menu_owner LIKE CONCAT('%', #{menuComboDto.menuOwner}, '%')
            </if>

            <!-- 动态条件：套餐名称 -->
            <if test="menuComboDto.comboName != null and menuComboDto.comboName != ''">
                AND combo.combo_name LIKE CONCAT('%', #{menuComboDto.comboName}, '%')
            </if>

            <!-- 动态条件：套餐负责人 -->
            <if test="menuComboDto.comboOwner != null and menuComboDto.comboOwner != ''">
                AND combo.combo_owner LIKE CONCAT('%', #{menuComboDto.comboOwner}, '%')
            </if>

            <!-- 动态条件：套餐类型 -->
            <if test="menuComboDto.comboType != null and menuComboDto.comboType != ''">
                AND combo.combo_type = #{menuComboDto.comboType}
            </if>

            <!-- 动态条件：销售地区 -->
            <if test="menuComboDto.salesArea != null and menuComboDto.salesArea != ''">
                AND combo.sales_area = #{menuComboDto.salesArea}
            </if>

            <!-- 动态条件：起始日期 -->
            <if test="menuComboDto.comboStartDate != null">
                AND combo.combo_start_date >= #{menuComboDto.comboStartDate}
            </if>

            <!-- 动态条件：结束日期 -->
            <if test="menuComboDto.comboEndDate != null">
                AND combo.combo_end_date &lt;= #{menuComboDto.comboEndDate}
            </if>
        </where>
    </select>
</mapper>
